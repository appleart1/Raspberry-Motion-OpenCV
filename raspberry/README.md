# Raspberry Pi
In this directory are files only for the raspberry pi.

## system/
system/ is for the system setup and represents "/"

## etc/
etc/motioneye is for motion(eye) setup or configurations

etc/motioneye/thread-1.conf will be generated by motioneye

## scripts

on_event_end.py: was the first script which updates the table motion_events

on_event_end_tf.py is the extension with tensorflow to classify what cat is eating and when

on_event_end.sh is the script which will trigger the python script above and may be later more


# Installations on Pi
```
sudo su -

# update every installed package and fix if something is broken
apt update
apt upgrade
dpkg --configure -a
apt --fix-broken install
apt upgrade

cd /boot
cp config.txt config.txt.bak
vi config.txt
reboot

# install motionEye and some dependencies
apt install vim ffmpeg v4l-utils libjpeg-dev libssl-dev libcurl4-openssl-dev python-dev nginx
pip install pycurl pytz motioneye sqlalchemy
apt install python-pandas python-mysqldb ipython

mkdir /home/pi/motioneye/etc
cp /usr/local/share/motioneye/extra/motioneye.conf.sample /home/pi/motioneye/etc/motioneye.conf
vi /home/pi/motioneye/etc/motioneye.conf 
# this should be under /home/pi/motioneye but will be ignored by media_path
mkdir /var/lib/motioneye
cp /usr/local/share/motioneye/extra/motioneye.systemd-unit-local /etc/systemd/system/motioneye.service

# make the cam working:
modprobe bcm2835-v4l2
ls /dev/video0 
vi /etc/modules

# install actual package of motion
wget https://github.com/Motion-Project/motion/releases/download/release-4.2.1/stretch_motion_4.2.1-1_amd64.deb
apt install libmicrohttpd12
dpkg -i ./pi_stretch_motion_4.2.1-1_armhf.deb

systemctl daemon-reload
systemctl enable motioneye
systemctl start motioneye

# install mariadb and clients and timezone support
apt install mariadb-client mariadb-server
mysql_tzinfo_to_sql  /usr/share/zoneinfo/Europe/Berlin 'Europe/Berlin' | mysql -u root mysql
mysql_tzinfo_to_sql  /usr/share/zoneinfo/UTC 'UTC' | mysql -u root mysql

# nfs to export motion pics
apt install nfs-kernel-server
echo "/home/pi/motioneye/pics/ *(rw,sync,no_subtree_check,all_squash)" >> /etc/exports
service nfs-kernel-server restart

cp raspberry/system/etc/sytemd/system/flask.service /etc/systemd/system/
systemctl daemon-reload
systemctl enable flask
systemctl start flask
```

## Some Links Good To Read
may look at:

https://github.com/lhelontra/tensorflow-on-arm
https://cloud.google.com/solutions/creating-object-detection-application-tensorflow
https://github.com/GoogleCloudPlatform/tensorflow-object-detection-example/blob/master/object_detection_app/app.py
https://medium.com/nanonets/how-to-easily-detect-objects-with-deep-learning-on-raspberrypi-225f29635c74
https://github.com/NanoNets/RaspberryPi-ObjectDetection-TensorFlow
